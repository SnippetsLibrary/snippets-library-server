/users:
  get:
    summary: Returns a list of users.
    tags: [user]
    description: Get all users
    parameters:
      - name: 'limit'
        in: 'query'
        description: 'max items count'
        required: false
        type: 'string'
      - name: 'offset'
        in: 'query'
        description: 'number of items to skip'
        required: false
        type: 'string'
    responses:
      '200':
        description: A JSON array of users
        content:
          application/json:
            # schema:
            #   allOf: # Combines the ApiResponse and the inline model
            #     - $ref: '#/components/schemas/ApiResponse'
            #     - type: object
            #       properties:
            #         payload:
            #           type: object
            #           properties:
            #             total: number
            #             items:
            #               type: array
            #               items:
            #                 $ref: '#/components/schemas/User'
            example:
              type: 'success'
              message: 'Users received'
              payload: { total: 13, items: [{ _id: f847js, name: mick, email: mick@example.com }] }
      '500':
        description: Server Error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApiResponse'
    security:
      - bearerAuth: []
/users/update/:
  patch:
    summary: update user if logged in
    tags: [user]
    description: Update user (can't update email!!!)
    requestBody:
      required: true
      content:
        application/json:
          schema:
            example:
              name: 'newName'
              pass: 'new1234'
    responses:
      '200':
        description: Result
        content:
          application/json:
            example:
              payload: userData
              message: user confirmed
              type: success
      '500':
        description: Some Error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApiResponse'
    security:
      - bearerAuth: []
/users/register:
  post:
    description: Register user
    tags: [user]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            example:
              name: 'mick'
              email: 'mick@f.com'
              pass: '1234'
    responses:
      '200':
        description: Success - validation email sent
        content:
          application/json:
            example:
              message: 'Confirm user via email'
              type: 'success'
      '409':
        description: Warning occurred
        content:
          application/json:
            example:
              message: 'User with such name or email already exists'
              type: 'warning'
      '500':
        description: Some error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApiResponse'
/users/login:
  post:
    description: Login user
    tags: [user]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            example:
              login: 'mick'
              pass: '1234'
    responses:
      '200':
        description: Success - user logged in - token received
        content:
          application/json:
            example:
              payload:
                {
                  token: Bearer fjhu98gh7uh9iu9ryhf79g8ru9hu4g79ey8uhg,
                  expires: Sun Jun 26 2022 11:36:22 GMT+0300,
                }
              message: user confirmed
              type: success
      '404':
        description: User not found
        content:
          application/json:
            example:
              message: 'No user with such credentials'
              type: 'warning'
      '500':
        description: Some error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApiResponse'
/users/confirm/{hash}:
  get:
    summary: Creates user after confirm
    tags: [user]
    description: Confirm user via link from email
    parameters:
      - name: 'hash'
        in: 'path'
        description: 'Confirmation hash'
        required: true
        type: 'string'
    responses:
      '200':
        description: A JSON session token
        content:
          application/json:
            example:
              payload:
                {
                  token: Bearer fjhu98gh7uh9iu9ryhf79g8ru9hu4g79ey8uhg,
                  expires: Sun Jun 26 2022 11:36:22 GMT+0300,
                }
              message: user confirmed
              type: success
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApiResponse'
            example:
              message: 'No such user in potential'
              type: 'error'
      '500':
        description: Some Error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApiResponse'
